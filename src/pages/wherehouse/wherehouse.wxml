<!--pages/wherehouse/wherehouse.wxml-->
<view class='wherehouse'>
  <view class='car-search'>
    <icon type="search" size="15" />
    <input 
      bindinput="doSearch" 
      value='{{inputValue}}' 
      placeholder="搜索" 
      placeholder-class='placeholder'
    />
  </view>
  
  <!-- <view class='select car-flex'> 
    <view bindtap='selectArea' class="car-flex">
      <text>全部地区</text>
      <Icon iconName='arrowDown' width='12px' height='6px' />
    </view> 
    <view bindtap='selectSort' class="car-flex">  
      <text>智能排序</text>
      <Icon iconName='arrowDown' width='12px' height='6px' />
    </view>
  </view> -->

  <view class='tab car-flex'> 
    <view bindtap='selectSort' class="car-flex" bindtap='tabSwitch' data-index='1'>  
      <text class='{{_active === "1"? "active": ""}}'>店铺</text>
    </view>
    <view bindtap='selectArea' class="car-flex" bindtap='tabSwitch' data-index='0'>
      <text class='{{_active === "0" ? "active" : ""}}'>汽车</text>
    </view> 
  </view>

  <view wx:if='{{_active === "1"}}'>
    <block wx:for="{{shopList}}" wx:key="{{item.id}}">
      <view class="wherehouse-shop">
        <view bindtap='goShop' data-id="{{item.id}}">
          <shopHead
            shopInfo='{{item.Shop}}'
            shopIntro='{{false}}'
            bind:followshop="unFollowShop"
          />
        </view>
        <view class='shop-info'>
          <view class='car-flex'>
            <text>仓库的车（{{item.FollowCars.length}}）</text>
            <block wx:if="{{item.FollowCars.length > 0}}">
              <block wx:if="{{item.isOpen}}">
                <Icon iconName="arrowsUp" width="12px" height="8px" bindtap='openCars' data-id='{{item.id}}' />
              </block>
              <block wx:else>
                <Icon iconName="arrowsDown" width="12px" height="8px" bindtap='openCars' data-id='{{item.id}}' />
              </block>
            </block>
          </view>
          <block wx:if="{{item.isOpen}}">
            <block wx:for="{{item.FollowCars}}"  wx:key="{{item.Car.id}}">
              <view class='shop-box'>
                <image src="{{item.Car.indexImage}}" mode='widthFix'></image>
                <view class='car-info'>
                  <view class='desc'>{{item.Car.brand}}</view>
                  <view class='car-flex'>
                    <text class='flex_1'>¥{{item.Car.price}}万</text>
                    <button class='add' bindtap='addWherehouse' data-id='{{item.Car.id}}'>
                      加入仓库
                    </button>
                  </view>
                </view>
              </view>
            </block>
          </block>
        </view>
        <view class='wherehouse-cars'>
          <scroll-view scroll-x class='cars-cell'>
            <block wx:for="{{item.Car}}" wx:key="{{item.id}}">
              <view catchtap='goCarDetail' class='carCard'>
                <shopCar carDetail="{{item}}"></shopCar>
              </view>
            </block>
          </scroll-view>
        </view>
      </view>
    </block>
  </view>

  <view wx:else>
    <block wx:for="{{carList}}" wx:key="{{item.id}}">
      <view class="wherehouse-shop">
        <!-- <view bindtap='goShop' data-id="{{item.id}}" class='shop-title'>
          <text>{{item.Shop.name}}</text>
        </view> -->
        <view class='wherehouse-cars'>
          <!-- <block wx:for="{{item.Car}}" wx:key="{{item.id}}"> -->
            <view catchtap='goCarDetail' class='carCard'>
              <carCard carDetail="{{item.Car}}"></carCard>
            </view>
          <!-- </block> -->
        </view>
      </view>
    </block>
  </view>

  <footer />
</view>
